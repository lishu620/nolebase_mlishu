在Rhel10更新之后，清除了Rhel9.5提供的dhcp-server项目，取而代之的是kea包，因此在Rhel10之后配置kea作为DHCP服务器

> [!WARNING] 警告
> 如果你重启过虚拟机，mount会失去挂载，需要重新输入mount /dev/sr0 /mnt/iso
> 或[[07.Rhel9.5补充文档#开机自动挂载安装镜像]]

## 前置条件

[[02.配置镜像源]]
[[03.创建新的网卡]]
## 安装/配置kea

```bash
dnf install -y kea
```

配置DHCP文件
```bash
mv /etc/kea/kea-dhcp4.conf /etc/kea/kea-dhcp4.conf.bak
vi /etc/kea/kea-dhcp4.conf
```

配置如下
```bash
{
  "Dhcp4": {
    "interfaces-config": {
      "interfaces": [ "ens37" ]
    },
    "lease-database": {
      "type": "memfile",
      "persist": true,
      "name": "/var/lib/kea/dhcp4.leases"
    },
    "subnet4": [
      {
	    "id": 1,
        "subnet": "192.168.159.0/24",
        "pools": [ { "pool": "192.168.159.100 - 192.168.159.199" } ],
        "option-data": [
          { "name": "routers", "data": "192.168.159.254" },
          { "name": "domain-name-servers", "data": "8.8.8.8" }
        ]
      }
    ]
  }
}
```

启动服务
```bash
systemctl enable --now kea-dhcp4
```

查看DHCP状态
```bash
systemctl status kea-dhcp4
```

当出现绿色的active (running)的时候，就表示配置完成

在其他连接到虚拟交换机NetGroup0的虚拟机上可以正常看到DHCP下发的IP
[[20729950326296a94cce49258edd6276_MD5.jpeg|Open: Pasted image 20250916205446.png]]
![[20729950326296a94cce49258edd6276_MD5.jpeg]]

## 查看DHCP租约

^696541

在DHCP服务器上输入：
```bash
cat /var/lib/kea/dhcp4.leases
```

可以看到DHCP分配给客户端的租约
```bash
192.168.159.100,00:0c:29:23:6d:f4,01:00:0c:29:23:6d:f4,7200,1758034421,1,0,0,,0,,0
```

到这里，DHCP服务器就配置完成了