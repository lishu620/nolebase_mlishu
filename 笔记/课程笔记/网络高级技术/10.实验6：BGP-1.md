## 实验拓扑
![[Pasted image 20251105154712.png]]
## 接口IP配置
### AR4
```
[AR4]int s1/0/0
[AR4-Serial1/0/0]ip add 10.0.14.4 255.255.255.0 
[AR4-Serial1/0/0]int lo1
[AR4-LoopBack1]ip add 10.1.4.4 255.255.255.0 
```
### AR1
```
[AR1]int s1/0/0
[AR1-Serial1/0/0]ip add 10.0.12.1 255.255.255.0
[AR1-Serial1/0/0]int s3/0/0
[AR1-Serial3/0/0]ip add 10.0.14.1 255.255.255.0 
[AR1-Serial3/0/0]int lo0
[AR1-LoopBack0]ip add 1.1.1.1 255.255.255.0
```
### AR2
```

```
### AR3
```

```
### AR5
```

```
## AS64512内部iBGP互通
### AR1
```
[AR1]ospf
[AR1-ospf-1]area 0
[AR1-ospf-1]network 1.1.1.0 0.0.0.255 
[AR1-ospf-1]network 10.0.12.0 0.0.0.255 
```
### AR2
```
[AR2]ospf
[AR2-ospf-1]area 0
[AR2-ospf-1]network 2.2.2.0 0.0.0.255
[AR2-ospf-1]network 10.0.12.0 0.0.0.255
[AR2-ospf-1]network 10.0.23.0 0.0.0.255
```
### AR3
```
[AR3]ospf
[AR3-ospf-1]area 0
[AR3-ospf-1]network 3.3.3.0 0.0.0.255 
[AR3-ospf-1]network 10.0.23.0 0.0.0.255 
```
在AR2上查看OSPF协议路由表
![[Pasted image 20251105171555.png]]
## 创建EBGP隧道
### AR1与AR4
```
[AR1]bgp 64512
[AR4-bgp]peer 10.0.14.4 as-number 64513
```

```
[AR4]bgp 64513
[AR4-bgp]peer 10.0.14.1 as-number 64512
```
### AR3和AR5
```
[AR3]bgp 64512
[AR3-bgp]peer 10.0.35.5 as-number 64514
```

```
[AR5]bgp 64514
[AR5-bgp]peer 10.0.35.3 as-number 64512
```
## 创建iBGP隧道并发布内部路由
### AR1
```
[AR1-bgp]peer 2.2.2.2 as-number 64512 
[AR1-bgp]peer 2.2.2.2 connect-interface LoopBack0
[AR1-bgp]peer 2.2.2.2 next-hop-local
[AR1-bgp]peer 3.3.3.3 as-number 64512 
[AR1-bgp]peer 3.3.3.3 connect-interface LoopBack0
[AR1-bgp]peer 3.3.3.3 next-hop-local
[AR1-bgp]network 10.0.12.0 24
[AR1-bgp]network 10.0.14.0 24
```
### AR2
```
[AR2-bgp]peer 1.1.1.1 as-number 64512
[AR2-bgp]peer 1.1.1.1 connect-interface LoopBack 0
[AR2-bgp]peer 1.1.1.1 next-hop-local
[AR2-bgp]peer 3.3.3.3 as-number 64512
[AR2-bgp]peer 3.3.3.3 connect-interface LoopBack 0
[AR2-bgp]peer 3.3.3.3 next-hop-local
[AR2-bgp]network 10.0.12.0 24
[AR2-bgp]network 10.0.23.0 24
```
### AR3
```
[AR3-bgp]peer 1.1.1.1 as-number 64512
[AR3-bgp]peer 1.1.1.1 connect-interface LoopBack 0
[AR3-bgp]peer 1.1.1.1 next-hop-local
[AR3-bgp]peer 2.2.2.2 as-number 64512
[AR3-bgp]peer 2.2.2.2 connect-interface LoopBack 0
[AR3-bgp]peer 2.2.2.2 next-hop-local
[AR3-bgp]network 10.0.23.0 24
[AR3-bgp]network 10.0.35.0 24
```
## 发布EBGP路由
### AR4
```
[AR4]bgp 64513
[AR4-bgp]network 10.1.4.0 24
```
### AR5
```
[AR5]bgp 64514
[AR5-bgp]network 10.1.5.0 24
```
## 检测
AR5访问AR4
![[Pasted image 20251105172839.png]]







