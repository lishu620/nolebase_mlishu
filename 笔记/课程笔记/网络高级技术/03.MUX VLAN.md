---
dg-publish: true
dg-home: false
author: mlishu
---
# MUX VLAN

# 目的

对不同用户进行网络隔离，如果都使用VLAN的方式进行隔离，可能会因为VLAN的数量多少受到限制（华为交换机默认4094个），并且VLAN越多，管理会越复杂。

使用MUX VLAN，可以实现网络隔离，节约VLAN，并且有足够的灵活性。

# 原理

MUX VLAN也包括了两个类型的vlan，也就是主vlan和从vlan，跟VLAN聚合的规划有些相似，但是从vlan又划分为两种类型（隔离型从vlan和互通型从vlan）。  
其中主端口可以和MUX VLAN内的所有端口进行通信；隔离型从vlan，vlan中的设备无法互访通信，而互通型从vlan，vlan中的设备可以互相通信；需要注意的是，不同vlan之间，就算都是互通型vlan（如果是跨设备的互通型从vlan，可以通信），是无法通信的。

MUX VLAN的从VLAN分为隔离从VLAN(IS-VLAN)和互通从VLAN(IN-VLAN)

# 目的

![image](assets/image-20250814102457-fzw3gkm.png)​

公司内部员工要求使用IN-VLAN互访，但是公司客户不允许互访，因此就不能用Super-VLAN，只能使用MUX-VLAN中的IS-VLAN

MUX VLAN是二层技术，不应该用于三层

# 配置

在LSW1上配置MUX VLAN	

```bash
vlan batch 10 20 100
vlan 100
mux-vlan
subordinate group 10
subordinate separate 20
int g0/0/1
port link-type trunk
port trunk allow-pass vlan 2 to 4094
int g0/0/2
port link-type trunk
port trunk allow-pass vlan 2 to 4094
int g0/0/24
port link-type access
port default vlan 100
port mux-vlan enable
```

在LSW2上配置IN-VLAN

```bash
vlan batch 10 20 100
vlan 100
mux-vlan
subordinate group 10
subordinate separate 20
int g0/0/1
port link-type trunk
port trunk allow-pass vlan 2 to 4094
int e0/0/1
port link-type access
port default vlan 10
port mux-vlan enable
int e0/0/2
port link-type access
port default vlan 10
port mux-vlan enable
```

在LSW3上配置IS-VLAN

```bash
vlan batch 10 20 100
vlan 100
mux-vlan
subordinate group 10
subordinate separate 20
int g0/0/1
port link-type trunk
port trunk allow-pass vlan 2 to 4094
int e0/0/1
port link-type access
port default vlan 20
port mux-vlan enable
int e0/0/2
port link-type access
port default vlan 20
port mux-vlan enable
```

‍
