## 拓扑图

![[Pasted image 20251009172627.png]]

## IP配置
### AR1

```
system
int g0/0/0
ip add 12.12.12.1 24
quit
ip route-static 0.0.0.0 0 12.12.12.254
```
### AR2

```
system
int g0/0/0
ip add 12.12.12.254 24
int g0/0/1
ip add 100.0.0.2 24
```
### AR3

```
system
int g0/0/0
ip add 100.0.0.3 24
int g0/0/1
ip add 200.0.0.3 24
```
### AR4

```
system
int g0/0/0
ip add 200.0.0.4 24
int g0/0/1
ip add 45.45.45.254 24
```
### AR5

```
system
int g0/0/0
ip add 45.45.45.5 24
quit
ip route-static 0.0.0.0 0 45.45.45.254
```
## 外网路由
### AR2

```
[huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 100.0.0.0 0.0.0.255
```
### AR3

```
[huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 100.0.0.0 0.0.0.255
[Huawei-ospf-1-area-0.0.0.0]network 200.0.0.0 0.0.0.255
```
### AR4

```
[huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 200.0.0.0 0.0.0.255
```
##  NAPT配置（AR2上配置）

```
[Huawei]nat address-group 1 100.0.0.10 100.0.0.20
[Huawei]acl 2000
[Huawei-acl-basic-2000]rule 10 permit source 12.12.12.0 0.0.0.255
[Huawei-acl-basic-2000]quit
[Huawei]int g0/0/1
[Huawei-GigabitEthernet0/0/1]nat outbound 2000 address-group 1
```
## Easy-IP配置（AR4上配置）

```
[Huawei]acl 2000
[Huawei-acl-basic-2000]rule 10 permit source 45.45.45.0 0.0.0.255
[Huawei-acl-basic-2000]q
[Huawei]int g0/0/0
[Huawei-GigabitEthernet0/0/0]nat outbound 2000
```
## NAT-Server配置（AR2上配置）
这里选择再AR1上使用telnet服务器
```
<Huawei>sys
Enter system view, return user view with Ctrl+Z.
[Huawei]user-interface vty 0 4
[Huawei-ui-vty0-4]
[Huawei-ui-vty0-4]idle-timeout 0 0
[Huawei-ui-vty0-4]authentication-mode password
Please configure the login password (maximum length 16):Huawei12#$
[Huawei-ui-vty0-4]user privilege level 3
```

```
nat server protocol tcp global current-interface 8023 inside 12.12.12.1 telnet
```