## 需求

1、R1、2、3是Level1路由器，R6、7是Level2路由器，SystemID是0000.0000.000X。ISIS进程号为10；
2、通告相关接口，通告每个路由器的LoopBack接口，网段192.168.X.0/24暂不通告；
3、R4和R6、R5和R6之间不能有DIS选举；
4、R1、2、3的共享网络中要求R3为DIS，在R1和R2上配置，优先级尽可能小且能参与选举；
5、R7引入网段并进行汇总，要求49.0001区域也可以学习；
6、区域49.0001需要进行认证，认证密码为huawei，MD5方式；
7、Level2路由器发送的IIH需要进行认证，认证密码为cqwu，MD5方式。
## 配置接口IP和ISIS进程
### AR1

```
<Huawei>undo t t
<Huawei>sys
[Huawei]sysn AR1
[AR1]isis 10
[AR1-isis-10]network-entity 49.0001.0000.0000.0001.00
[AR1-isis-10]is-level level-1
[AR1-isis-10]int g0/0/0
[AR1-GigabitEthernet0/0/0]ip add 10.0.123.1 24
[AR1-GigabitEthernet0/0/0]isis enable 10
[AR1-GigabitEthernet0/0/0]int lo0
[AR1-LoopBack0]ip add 1.1.1.1 32
[AR1-LoopBack0]isis enable 10
```
### AR2

```
<Huawei>undo t t
<Huawei>sys
[Huawei]sysn AR2
[AR2]isis 10
[AR2-isis-10]network-entity 49.0001.0000.0000.0002.00
[AR2-isis-10]is-level level-1
[AR2-isis-10]int g0/0/0
[AR2-GigabitEthernet0/0/0]ip add 10.0.123.2 24
[AR2-GigabitEthernet0/0/0]isis enable 10
[AR2-GigabitEthernet0/0/0]int lo0
[AR2-LoopBack0]ip add 2.2.2.2 32
[AR2-LoopBack0]isis enable 10
```
### AR3

```
<Huawei>undo t t
<Huawei>sys 
[Huawei]sysn AR3
[AR3]isis 10
[AR3-isis-10]network-entity 49.0001.0000.0000.0003.00
[AR3-isis-10]is-level level-1
[AR3-isis-10]int g0/0/0
[AR3-GigabitEthernet0/0/0]ip add 10.0.123.3 24
[AR3-GigabitEthernet0/0/0]isis enable 10
[AR3-GigabitEthernet0/0/0]int lo0
[AR3-LoopBack0]ip add 3.3.3.3 32
[AR3-LoopBack0]isis enable 10
[AR3-LoopBack0]int s4/0/0
[AR3-Serial4/0/0]ip add 10.0.34.3 24
[AR3-Serial4/0/0]isis enable 10
[AR3-Serial4/0/0]int s4/0/1
[AR3-Serial4/0/1]ip add 10.0.35.3 24
[AR3-Serial4/0/1]isis enable 10
```
### AR4

```
<Huawei>undo t t
<Huawei>sys
[Huawei]sysn AR4
[AR4]isis 10
[AR4-isis-10]network-entity 49.0001.0000.0000.0004.00
[AR4-isis-10]int s4/0/0
[AR4-Serial4/0/0]ip add 10.0.34.4 24
[AR4-Serial4/0/0]isis enable 10
[AR4-Serial4/0/0]int g0/0/0
[AR4-GigabitEthernet0/0/0]ip add 10.0.46.4 24
[AR4-GigabitEthernet0/0/0]isis enable 10
[AR4]int lo0
[AR4-LoopBack0]ip add 4.4.4.4 32
[AR4-LoopBack0]isis enable 10
```
### AR5

```
<Huawei>undo t t
<Huawei>sys
[Huawei]sysn AR5
[AR5]isis 10
[AR5-isis-10]network-entity 49.0001.0000.0000.0005.00
[AR5-isis-10]int s4/0/0
[AR5-Serial4/0/0]ip add 10.0.35.5 24
[AR5-Serial4/0/0]isis enable 10
[AR5-Serial4/0/0]int g0/0/0
[AR5-GigabitEthernet0/0/0]ip add 10.0.56.5 24
[AR5-GigabitEthernet0/0/0]isis enable 10
[AR5-GigabitEthernet0/0/0]int lo0
[AR5-LoopBack0]ip add 5.5.5.5 32
[AR5-LoopBack0]isis enable 10
```
### AR6

```
<Huawei>undo t t
<Huawei>sys
[Huawei]sysn AR6
[AR6]isis 10
[AR6-isis-10]network-entity 49.0002.0000.0000.0006.00
[AR6-isis-10]is-level level-2
[AR6-isis-10]int g0/0/0
[AR6-GigabitEthernet0/0/0]ip add 10.0.46.6 24
[AR6-GigabitEthernet0/0/0]isis enable 10
[AR6-GigabitEthernet0/0/0]int g0/0/1
[AR6-GigabitEthernet0/0/1]ip add 10.0.56.6 24
[AR6-GigabitEthernet0/0/1]isis enable 10
[AR6]int lo0
[AR6-LoopBack0]ip add 6.6.6.6 32
[AR6-LoopBack0]isis enable 10
[AR6]int g0/0/2
[AR6-GigabitEthernet0/0/2]ip add 10.0.67.6 24 
[AR6-GigabitEthernet0/0/2]isis enable 10
```
### AR7

```
<Huawei>undo t t
<Huawei>sys
[Huawei]sysn AR7
[AR7]isis 10
[AR7-isis-10]network-entity 49.0002.0000.0007.00
[AR7-isis-10]is-level level-2
[AR7-isis-10]int g0/0/0
[AR7-GigabitEthernet0/0/0]ip add 10.0.67.7 24
[AR7-GigabitEthernet0/0/0]isis enable 10
[AR7]int lo0
[AR7-LoopBack0]ip add 7.7.7.7 32
[AR7-LoopBack0]isis enable 10
[AR7-LoopBack0]int lo1
[AR7-LoopBack1]ip add 192.168.0.0 24
Error: The specified IP address is invalid.
[AR7-LoopBack1]ip add 192.168.0.1 24
[AR7-LoopBack1]isis enable 10
[AR7-LoopBack1]int lo2
[AR7-LoopBack2]ip add 192.168.1.1 24
[AR7-LoopBack2]isis enable 10
[AR7-LoopBack2]int lo3
[AR7-LoopBack3]ip add 192.168.2.1 24
[AR7-LoopBack3]isis enable 10
[AR7-LoopBack3]int lo4
[AR7-LoopBack4]ip add 192.168.3.1 24
[AR7-LoopBack4]isis enable 10
```
## 不能有DIS选举
### AR4

```
[AR4]int g0/0/0
[AR4-GigabitEthernet0/0/0]isis circuit-type p2p 
```
### AR5

```
[AR5]int g0/0/0
[AR5-GigabitEthernet0/0/0]isis circuit-type p2p 
```
### AR6

```
[AR6]int g0/0/0
[AR6-GigabitEthernet0/0/0]isis circuit-type p2p 
[AR6-GigabitEthernet0/0/0]int g0/0/1
[AR6-GigabitEthernet0/0/1]isis circuit-type p2p 
```
## 优先级小选举
### AR1

```
[AR1]int g0/0/0
[AR1-GigabitEthernet0/0/0]isis dis-priority 0 level-1
```
### AR2

```
[AR2]int g0/0/0
[AR2-GigabitEthernet0/0/0]isis dis-priority 0 level-1
```

在AR3上查看DIS
![[Pasted image 20251023114826.png]]
## 路由汇总和路由渗透
### 路由汇总

```
[AR7]isis 10
[AR7-isis-10]summary 192.168.0.0 255.255.252.0 level-2
```

汇总前：
![[Pasted image 20251023115217.png]]
汇总后：
![[Pasted image 20251023115149.png]]
### 路由渗透

```
[AR4]ip ip-prefix 1 permit 192.168.0.0 22 greater-equal 22 less-equal 22
[AR4]isis 10
[AR4-isis-10]import-route isis level-2 into level-1 filter-policy ip-prefix 1
```

引入前：
![[Pasted image 20251023115418.png]]
引入后：
![[Pasted image 20251023115527.png]]
## 区域认证
### AR1

```
[AR1]isis 10
[AR1-isis-10]area-authentication-mode md5 huawei
```
### AR2

```
[AR2]isis 10
[AR2-isis-10]area-authentication-mode md5 huawei
```
### AR3

```
[AR3]isis 10
[AR3-isis-10]area-authentication-mode md5 huawei
```
### AR4

```
[AR4]isi 10
[AR4-isis-10]area-authentication-mode md5 huawei
```
### AR5

```
[AR5]isis 10
[AR5-isis-10]area-authentication-mode md5 huawei
```

## 接口认证
### AR4

```
[AR4]int g0/0/0
[AR4-GigabitEthernet0/0/0]isis authentication-mode md5 cqwu
```

### AR5

```
[AR5]int g0/0/0
[AR5-GigabitEthernet0/0/0]isis authentication-mode md5 cqwu
```
### AR6

```
[AR6]int g0/0/0
[AR6-GigabitEthernet0/0/0]isis authentication-mode md5 cqwu
[AR6-GigabitEthernet0/0/0]int g0/0/1
[AR6-GigabitEthernet0/0/1]isis authentication-mode md5 cqwu
```
### AR7

```
[AR7]int g0/0/0
[AR7-GigabitEthernet0/0/0]isis authentication-mode md5 cqwu
```



